include:
  - project: tvconss/gitlab-tools
    ref: main
    file: sync-to-github/.gitlab-ci.yml

stages:
  - sync-to-github
  - build_and_deploy

variables:
  GITHUB_REPO: "aliconcon-ecommerce-customer"

deploy_client_customer:
  stage: build_and_deploy
  image: docker:latest
  needs: []
  variables:
    DOCKER_HOST: unix:///var/run/docker.sock
    CONTAINER_NAME: "aliconcon-client-customer"
    IMAGE_NAME: "aliconcon-client-customer"
    APP_PORT: 3007
  before_script:
    - docker info

  script:
    # 1. Build and Run using Docker Compose
    - echo "üèóÔ∏è Building and deploying with Docker Compose..."
    - docker compose build
    - docker compose up -d

    - echo "‚úÖ Deployment complete!"

  only:
    - main
    - master

  tags:
    - docker
